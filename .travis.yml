sudo: false
language: java
jdk: oraclejdk7
cache:
  directories:
  - $HOME/.m2
env:
  matrix:
  - DISPLAY=:99.0
  global:
    secure: JlyegDL2Py0e0PWdFrOWIw915LN30HXlqJjsYh69LXaRj/10l4Kf9SZIKKzX33Vs8Ng9GCbHRhu/LUBnPGMB2HIVYGbdfz6FKfavWb0pD6kfMiLZ7jAFQQly9681Vkscv5RwMGtRzTJA1T5zUFzB5PsKacBCh/vc5CDhJzHpF/s=
before_install:
- sh -e /etc/init.d/xvfb start - sleep 10
script:
- cd releng/org.yakindu.sct.releng
- mvn clean verify
- cd ../org.yakindu.sct.repository/target/repository
- zip -r updatesite.zip *.*
deploy:
  skip_cleanup: true
  provider: releases
  api_key: ${GITHUB_TOKEN}
  file: ../org.yakindu.sct.repository/target/repository/updatesite.zip
  on:
    tags: Yakindu/statecharts
    condition: $TRAVIS_TAG =~ ^release.*$
